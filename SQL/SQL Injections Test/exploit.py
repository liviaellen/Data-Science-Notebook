import sqlite3
conn = sqlite3.connect('data/exploitable_db.sqlite')
c = conn.cursor()

def connect(username, password):
  query = f"""
    SELECT *
    FROM users
    WHERE users.username = '{username}'
    AND  users.password = '{password}'
  """
  c.execute(query)
  user = c.fetchone()
  if user is None:
    return "Unauthorized"
  else:
    return "Authorized"



def connect_good(username, password):
  query = """
    SELECT *
    FROM users
    WHERE users.username = '?'
    AND  users.password = '?'
  """
  c.execute(query, (username, password))
  user = c.fetchone()
  if user is None:
    return "Unauthorized"
  else:
    return "Authorized"

# print(connect("john", "passwo0rd"))
print(connect("john", "'OR 1=1 --"))
